import{_ as P,r as t,c as k,a as f,b as s,d as L,w as E,e as N,f as d,n as p,u as r,s as b,g as S,t as T,h as x,i as _,o as y}from"./index-CE-419vR.js";import{A as B}from"./auth.service-uGQoot8G.js";import"./httpClient-DusnwknQ.js";const D={class:"login-container"},I={class:"login-box"},R={class:"role-selector"},$={class:"form-group"},q={class:"p-input-icon-left"},A={class:"form-group"},U={class:"p-input-icon-left"},z={key:0,class:"error-message"},G={__name:"LoginPage",setup(M){const u=t(""),c=t(""),a=t(""),i=t(!1),n=t("tourist"),v=_(),w=new B,g=k(()=>u.value.trim()&&c.value.trim());async function V(){if(!(i.value||!g.value)){i.value=!0,a.value="";try{const o={email:u.value,password:c.value,role:n.value};console.log("LoginPage: Intentando login con:",{email:o.email,role:o.role});const e=await w.login(o);if(console.log("LoginPage: Login exitoso:",e),!e||!e.role)throw new Error("No se recibió una sesión válida");const l=v.currentRoute.value.query.redirect,C=e.role==="agency"?"/manage-experiences":"/experiences",m=l||C;console.log("LoginPage: Redirigiendo a",m),await v.replace(m)}catch(o){console.error("Error en login:",o),a.value=o.message||"Error al iniciar sesión. Por favor, intenta nuevamente."}finally{i.value=!1}}}return(o,e)=>(y(),f("div",D,[s("div",I,[e[11]||(e[11]=s("div",{class:"login-header"},[s("img",{src:L,alt:"EcoTrip",class:"login-logo"}),s("h1",null,"¡Bienvenido a EcoTrip!"),s("p",{class:"subtitle"},"Descubre experiencias sostenibles")],-1)),s("form",{onSubmit:E(V,["prevent"]),class:"login-form"},[s("div",R,[s("div",{class:p(["role-card",{active:n.value==="tourist"}]),onClick:e[0]||(e[0]=l=>n.value="tourist")},e[5]||(e[5]=[s("i",{class:"pi pi-user role-icon"},null,-1),s("div",{class:"role-info"},[s("h3",null,"Turista"),s("p",null,"Descubre experiencias únicas")],-1)]),2),s("div",{class:p(["role-card",{active:n.value==="agency"}]),onClick:e[1]||(e[1]=l=>n.value="agency")},e[6]||(e[6]=[s("i",{class:"pi pi-briefcase role-icon"},null,-1),s("div",{class:"role-info"},[s("h3",null,"Agencia"),s("p",null,"Gestiona tus experiencias")],-1)]),2)]),s("div",$,[s("span",q,[e[7]||(e[7]=s("i",{class:"pi pi-envelope"},null,-1)),d(r(b),{id:"email",modelValue:u.value,"onUpdate:modelValue":e[2]||(e[2]=l=>u.value=l),type:"email",class:p(["p-inputtext-lg",{"p-invalid":!!a.value}]),placeholder:n.value==="tourist"?"tourist@demo.com":"agency@demo.com",required:""},null,8,["modelValue","class","placeholder"])])]),s("div",A,[s("span",U,[e[8]||(e[8]=s("i",{class:"pi pi-lock"},null,-1)),d(r(b),{id:"password",modelValue:c.value,"onUpdate:modelValue":e[3]||(e[3]=l=>c.value=l),type:"password",class:p(["p-inputtext-lg",{"p-invalid":!!a.value}]),placeholder:"Contraseña",required:""},null,8,["modelValue","class"])])]),a.value?(y(),f("div",z,[e[9]||(e[9]=s("i",{class:"pi pi-exclamation-circle"},null,-1)),S(" "+T(a.value),1)])):N("",!0),d(r(x),{type:"submit",label:i.value?"Iniciando sesión...":"Iniciar Sesión",disabled:i.value||!g.value,loading:i.value,class:"p-button-lg"},null,8,["label","disabled","loading"]),e[10]||(e[10]=s("div",{class:"divider"},[s("span",null,"¿No tienes una cuenta?")],-1)),d(r(x),{type:"button",label:"Crear cuenta nueva",class:"p-button-outlined p-button-lg",onClick:e[4]||(e[4]=l=>r(v).push("/register"))})],32)]),e[12]||(e[12]=s("div",{class:"login-banner"},[s("div",{class:"banner-content"},[s("h2",null,"Descubre nuevas aventuras"),s("p",null,"Conecta con experiencias sostenibles y auténticas")])],-1))]))}},H=P(G,[["__scopeId","data-v-6289261c"]]);export{H as default};
