import{_ as $,r as v,m as N,A as D,i as A,a as r,b as s,f as a,l,g as o,j as B,t as _,u as n,v as x,h as g,x as P,y as T,o as u}from"./index-BHEtbWzy.js";import{E as V}from"./experience.service-D4S5l8TK.js";import"./httpClient-Bnjko1En.js";const I={class:"manage-experiences"},U={class:"header"},j={key:0,class:"loading-state"},q={key:1,class:"error-state"},z={key:2},F={key:0,class:"empty-state"},G={key:1,class:"experiences-table"},L={__name:"manage-experiences.page",setup(M){const b=A(),k=new V,c=v([]),p=v(!0),f=v(null),d=v(!1),m=v(null);N(async()=>{const i=D.fromStorage();if(!(i!=null&&i.isAgency())){b.push("/experiences");return}await E(i.userId)});async function E(i){try{p.value=!0,c.value=await k.getExperiencesByAgency(i)}catch(e){console.error("Error loading experiences:",e),f.value=e.message}finally{p.value=!1}}function h(i){b.push(`/manage-experiences/${i}/edit`)}function w(i){m.value=i,d.value=!0}async function C(){try{p.value=!0,await k.deleteExperience(m.value.id.value),c.value=c.value.filter(i=>i.id.value!==m.value.id.value),d.value=!1,m.value=null}catch(i){console.error("Error deleting experience:",i),f.value=i.message}finally{p.value=!1}}return(i,e)=>{const y=B("router-link");return u(),r("div",I,[s("div",U,[e[3]||(e[3]=s("h1",null,"Gestionar Experiencias",-1)),a(y,{to:"/manage-experiences/create",class:"create-button"},{default:l(()=>e[2]||(e[2]=[s("i",{class:"pi pi-plus"},null,-1),o(" Nueva Experiencia ")])),_:1,__:[2]})]),p.value?(u(),r("div",j,e[4]||(e[4]=[s("i",{class:"pi pi-spin pi-spinner"},null,-1),o(" Cargando experiencias... ")]))):f.value?(u(),r("div",q,[e[5]||(e[5]=s("i",{class:"pi pi-exclamation-triangle"},null,-1)),o(" "+_(f.value),1)])):(u(),r("div",z,[c.value.length===0?(u(),r("div",F,[e[7]||(e[7]=s("i",{class:"pi pi-info-circle"},null,-1)),e[8]||(e[8]=s("p",null,"No has creado ninguna experiencia aún",-1)),a(y,{to:"/manage-experiences/create",class:"create-link"},{default:l(()=>e[6]||(e[6]=[o(" Crear mi primera experiencia ")])),_:1,__:[6]})])):(u(),r("div",G,[a(n(P),{value:c.value,paginator:!0,rows:10,rowsPerPageOptions:[5,10,20],responsiveLayout:"scroll"},{default:l(()=>[a(n(x),{field:"title.value",header:"Título"},{body:l(({data:t})=>[a(y,{to:"/experiences/"+t.id.value},{default:l(()=>[o(_(t.title.value),1)]),_:2},1032,["to"])]),_:1}),a(n(x),{field:"location.value",header:"Ubicación"}),a(n(x),{field:"price.value",header:"Precio"},{body:l(({data:t})=>[o(_(t.getFormattedPrice()),1)]),_:1}),a(n(x),{headerStyle:"width:4rem"},{body:l(({data:t})=>[a(n(g),{icon:"pi pi-pencil",class:"p-button-rounded p-button-text",onClick:S=>h(t.id.value)},null,8,["onClick"])]),_:1}),a(n(x),{headerStyle:"width:4rem"},{body:l(({data:t})=>[a(n(g),{icon:"pi pi-trash",class:"p-button-rounded p-button-text p-button-danger",onClick:S=>w(t)},null,8,["onClick"])]),_:1})]),_:1},8,["value"])]))])),a(n(T),{visible:d.value,"onUpdate:visible":e[1]||(e[1]=t=>d.value=t),modal:"",style:{width:"450px"},header:"Confirmar Eliminación"},{footer:l(()=>[a(n(g),{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:e[0]||(e[0]=t=>d.value=!1)}),a(n(g),{label:"Sí",icon:"pi pi-check",class:"p-button-danger",onClick:C})]),default:l(()=>[e[9]||(e[9]=s("div",{class:"confirmation-content"},[s("i",{class:"pi pi-exclamation-triangle",style:{"font-size":"2rem"}}),s("span",null,"¿Estás seguro de que deseas eliminar esta experiencia?")],-1))]),_:1,__:[9]},8,["visible"])])}}},J=$(L,[["__scopeId","data-v-c0a7e4f3"]]);export{J as default};
