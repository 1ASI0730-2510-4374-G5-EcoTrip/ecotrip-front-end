import{_ as B,i as q,a as r,o as l,b as i,e as D,t as a,g,F as L,k as R,r as y,l as Y,c as U,m as z,A as J,p as W,q as h,v as G,x as M,y as V,z as H,B as K,C as X,D as Z}from"./index-BPhHBPve.js";import{E as ee}from"./experience.service-ClOJtLbE.js";import{u as te}from"./page-state.service-dWtiwY-7.js";import"./httpClient-DpjTLT7X.js";const se={class:"image-container"},ie=["src","alt"],ne={class:"image-overlay"},oe={class:"difficulty-badge"},le={key:0,class:"eco-badge"},re={class:"experience-content"},ae={class:"experience-header"},ce={class:"experience-title"},ue={class:"price-container"},pe={class:"experience-price"},de={class:"experience-location"},ve={class:"experience-duration"},fe={class:"experience-type"},ge={class:"experience-footer"},xe={key:0,class:"rating-container"},ye={class:"stars"},me={class:"rating-text"},Ee={class:"participants"},_e={__name:"experience-card.component",props:{experience:{type:Object,required:!0}},setup(I){const T=q(),o=I,c=()=>{var s,e;console.log("[ExperienceCard] ================="),console.log("[ExperienceCard] RAW Experience object:",JSON.stringify(o.experience,null,2)),console.log("[ExperienceCard] Experience keys:",Object.keys(o.experience||{}));const t=(s=o.experience)==null?void 0:s.id;if(console.log("[ExperienceCard] Experience ID extracted:",t),console.log("[ExperienceCard] ID type:",typeof t),console.log("[ExperienceCard] ID constructor:",(e=t==null?void 0:t.constructor)==null?void 0:e.name),t){const n=String(t);console.log("[ExperienceCard] String ID:",n),console.log("[ExperienceCard] Navigating to:",`/experiences/${n}`),T.push(`/experiences/${n}`)}else console.error("[ExperienceCard] No experience ID found");console.log("[ExperienceCard] =================")},u=()=>{var t;return((t=o.experience)==null?void 0:t.title)||"Experiencia"},m=()=>{var s;const t=(s=o.experience)==null?void 0:s.images;return Array.isArray(t)&&t.length>0?t[0]:"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800"},b=()=>{var t;return((t=o.experience)==null?void 0:t.location)||"Ubicación no disponible"},C=()=>{var t;return((t=o.experience)==null?void 0:t.type)||"Aventura"},p=()=>{var t;return((t=o.experience)==null?void 0:t.difficultyLevel)||"Moderado"},d=()=>{var t;return((t=o.experience)==null?void 0:t.maxParticipants)||"8"},v=()=>{var s;const t=(s=o.experience)==null?void 0:s.duration;if(t!=null&&t.value&&(t!=null&&t.unit)){const e={hours:"horas",days:"días",minutes:"minutos"};return`${t.value} ${e[t.unit]||t.unit}`}return"Duración no disponible"},f=()=>{var s;const t=(s=o.experience)==null?void 0:s.price;return t!=null&&t.amount&&(t!=null&&t.currency)?`${t.currency==="EUR"?"€":"$"} ${t.amount}`:"Precio no disponible"},x=()=>{var t;return((t=o.experience)==null?void 0:t.isSustainable)===!0},k=()=>{var t,s;return((t=o.experience)==null?void 0:t.rating)&&((s=o.experience)==null?void 0:s.reviewCount)},S=()=>{var t;return((t=o.experience)==null?void 0:t.rating)||0},$=()=>{var t;return((t=o.experience)==null?void 0:t.reviewCount)||0},w=()=>Math.floor(S()),E=()=>5-w(),F=t=>{t.target.src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800"};return(t,s)=>(l(),r("div",{class:"experience-card",onClick:c},[i("div",se,[i("img",{src:m(),alt:u(),class:"experience-image",onError:F},null,40,ie),i("div",ne,[i("div",oe,a(p()),1),x()?(l(),r("div",le,s[0]||(s[0]=[i("i",{class:"pi pi-leaf"},null,-1),g(" Eco ")]))):D("",!0)])]),i("div",re,[i("div",ae,[i("h3",ce,a(u()),1),i("div",ue,[i("span",pe,a(f()),1),s[1]||(s[1]=i("span",{class:"price-per"},"por persona",-1))])]),i("p",de,[s[2]||(s[2]=i("i",{class:"pi pi-map-marker"},null,-1)),g(" "+a(b()),1)]),i("p",ve,[s[3]||(s[3]=i("i",{class:"pi pi-clock"},null,-1)),g(" "+a(v()),1)]),i("div",fe,[s[4]||(s[4]=i("i",{class:"pi pi-tag"},null,-1)),g(" "+a(C()),1)]),i("div",ge,[k()?(l(),r("div",xe,[i("div",ye,[(l(!0),r(L,null,R(w(),e=>(l(),r("i",{class:"pi pi-star-fill",key:"full-"+e}))),128)),(l(!0),r(L,null,R(E(),e=>(l(),r("i",{class:"pi pi-star",key:"empty-"+e}))),128))]),i("span",me,a(S())+" ("+a($())+")",1)])):D("",!0),i("div",Ee,[s[5]||(s[5]=i("i",{class:"pi pi-users"},null,-1)),g(" Máx. "+a(d()),1)])])])]))}},be=B(_e,[["__scopeId","data-v-64361ed0"]]),ke={class:"experience-list"},he={class:"header"},Ce={class:"filters-section"},Se={class:"search-container"},$e={class:"filters"},we={class:"filter-group"},De=["value"],Le={class:"filter-group"},Re={class:"filter-group"},Te={class:"filter-group"},Fe={class:"checkbox-label"},Me={key:0,class:"results-info"},Ie={key:1,class:"loading-state"},Ne={key:2,class:"error-state"},Pe={key:3,class:"empty-state"},Ae={key:4,class:"experiences-grid"},Ue={__name:"experience-list.page",setup(I){const T=q();X();const o=new ee,c=te("experiences"),u=y([]),m=y(!0),b=y(null),C=y(!1),p=y(""),d=y(""),v=y(""),f=y(""),x=y(!1),k=()=>{const s={filters:{searchQuery:p.value,selectedType:d.value,selectedDifficulty:v.value,selectedPriceRange:f.value,onlyEcoFriendly:x.value},scrollPosition:window.scrollY,data:u.value};c.saveState(s)},S=()=>{if(c.hasState()){console.log("[ExperienceList] Restoring previous state..."),c.setRestoring(!0);const s=c.restoreState();return s.filters&&(p.value=s.filters.searchQuery||"",d.value=s.filters.selectedType||"",v.value=s.filters.selectedDifficulty||"",f.value=s.filters.selectedPriceRange||"",x.value=s.filters.onlyEcoFriendly||!1),s.data&&s.data.length>0&&(u.value=s.data,m.value=!1),K(()=>{c.restoreScroll(),c.setRestoring(!1)}),!0}return!1};Y([p,d,v,f,x],()=>{c.isRestoring()||k()},{deep:!0});let $;window.addEventListener("scroll",()=>{clearTimeout($),$=setTimeout(()=>{c.isRestoring()||c.saveScroll(window.scrollY)},100)});const w=U(()=>{const s=u.value.map(e=>{var n;return((n=e.type)==null?void 0:n.value)||e.type}).filter(Boolean);return[...new Set(s)]}),E=U(()=>{let s=u.value;if(p.value.trim()){const e=p.value.toLowerCase().trim();s=s.filter(n=>{var N,P,A;const _=(((N=n.title)==null?void 0:N.value)||n.title||"").toLowerCase(),j=(n.description||"").toLowerCase(),O=(((P=n.location)==null?void 0:P.value)||n.location||"").toLowerCase(),Q=(((A=n.type)==null?void 0:A.value)||n.type||"").toLowerCase();return _.includes(e)||j.includes(e)||O.includes(e)||Q.includes(e)})}return d.value&&(s=s.filter(e=>{var n;return(((n=e.type)==null?void 0:n.value)||e.type)===d.value})),v.value&&(s=s.filter(e=>{var n;return(((n=e.difficultyLevel)==null?void 0:n.value)||e.difficultyLevel)===v.value})),f.value&&(s=s.filter(e=>{var _;const n=((_=e.price)==null?void 0:_.amount)||0;switch(f.value){case"0-100":return n>=0&&n<=100;case"101-300":return n>=101&&n<=300;case"301-500":return n>=301&&n<=500;case"501+":return n>=501;default:return!0}})),x.value&&(s=s.filter(e=>e.isSustainable===!0)),s});z(async()=>{var n;const s=J.fromStorage();if(C.value=(s==null?void 0:s.isAgency())??!1,!S())try{m.value=!0,u.value=await o.getAllExperiences(),console.log("[ExperienceList] Loaded experiences:",u.value),console.log("[ExperienceList] First experience:",u.value[0]),console.log("[ExperienceList] First experience ID:",(n=u.value[0])==null?void 0:n.id),k()}catch(_){console.error("Error loading experiences:",_),b.value=_.message}finally{m.value=!1}}),W(()=>{console.log("[ExperienceList] Saving state before unmount..."),k()});function F(){k(),T.push("/manage-experiences/create")}function t(){p.value="",d.value="",v.value="",f.value="",x.value=!1}return(s,e)=>(l(),r("div",ke,[i("div",he,[e[6]||(e[6]=i("div",{class:"header-content"},[i("h1",null,"Explorar Experiencias"),i("p",{class:"subtitle"},"Descubre aventuras únicas y sostenibles")],-1)),C.value?(l(),r("button",{key:0,onClick:F,class:"create-button"},e[5]||(e[5]=[i("i",{class:"pi pi-plus"},null,-1),g(" Nueva Experiencia ")]))):D("",!0)]),i("div",Ce,[i("div",Se,[e[7]||(e[7]=i("i",{class:"pi pi-search"},null,-1)),h(i("input",{type:"text",placeholder:"Buscar experiencias...","onUpdate:modelValue":e[0]||(e[0]=n=>p.value=n),class:"search-input"},null,512),[[G,p.value]])]),i("div",$e,[i("div",we,[e[9]||(e[9]=i("label",null,"Tipo:",-1)),h(i("select",{"onUpdate:modelValue":e[1]||(e[1]=n=>d.value=n),class:"filter-select"},[e[8]||(e[8]=i("option",{value:""},"Todos",-1)),(l(!0),r(L,null,R(w.value,n=>(l(),r("option",{key:n,value:n},a(n),9,De))),128))],512),[[M,d.value]])]),i("div",Le,[e[11]||(e[11]=i("label",null,"Dificultad:",-1)),h(i("select",{"onUpdate:modelValue":e[2]||(e[2]=n=>v.value=n),class:"filter-select"},e[10]||(e[10]=[V('<option value="" data-v-573878e7>Todas</option><option value="Fácil" data-v-573878e7>Fácil</option><option value="Moderado" data-v-573878e7>Moderado</option><option value="Difícil" data-v-573878e7>Difícil</option><option value="Moderado a Difícil" data-v-573878e7>Moderado a Difícil</option>',5)]),512),[[M,v.value]])]),i("div",Re,[e[13]||(e[13]=i("label",null,"Precio:",-1)),h(i("select",{"onUpdate:modelValue":e[3]||(e[3]=n=>f.value=n),class:"filter-select"},e[12]||(e[12]=[V('<option value="" data-v-573878e7>Cualquier precio</option><option value="0-100" data-v-573878e7>€0 - €100</option><option value="101-300" data-v-573878e7>€101 - €300</option><option value="301-500" data-v-573878e7>€301 - €500</option><option value="501+" data-v-573878e7>€501+</option>',5)]),512),[[M,f.value]])]),i("div",Te,[i("label",Fe,[h(i("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=n=>x.value=n)},null,512),[[H,x.value]]),e[14]||(e[14]=i("span",{class:"checkmark"},null,-1)),e[15]||(e[15]=g(" Solo eco-friendly "))])]),i("button",{onClick:t,class:"clear-filters-btn"},e[16]||(e[16]=[i("i",{class:"pi pi-times"},null,-1),g(" Limpiar ")]))])]),!m.value&&!b.value?(l(),r("div",Me,[i("p",null,a(E.value.length)+" experiencia"+a(E.value.length!==1?"s":"")+" encontrada"+a(E.value.length!==1?"s":""),1)])):D("",!0),m.value?(l(),r("div",Ie,e[17]||(e[17]=[i("i",{class:"pi pi-spin pi-spinner"},null,-1),g(" Cargando experiencias... ")]))):b.value?(l(),r("div",Ne,[e[18]||(e[18]=i("i",{class:"pi pi-exclamation-triangle"},null,-1)),g(" "+a(b.value),1)])):E.value.length===0?(l(),r("div",Pe,e[19]||(e[19]=[i("i",{class:"pi pi-search"},null,-1),i("h3",null,"No se encontraron experiencias",-1),i("p",null,"Intenta modificar los filtros para encontrar más resultados",-1)]))):(l(),r("div",Ae,[(l(!0),r(L,null,R(E.value,n=>(l(),Z(be,{key:n.id,experience:n},null,8,["experience"]))),128))]))]))}},Oe=B(Ue,[["__scopeId","data-v-573878e7"]]);export{Oe as default};
