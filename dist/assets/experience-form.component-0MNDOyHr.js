import{_ as D,c as M,q as P,r as b,m as $,A as E,i as F,a as r,b as l,t as k,f as i,u,s as c,z as U,B as C,C as _,F as y,p as V,g as I,w as R,o as d}from"./index-BHEtbWzy.js";import{E as T}from"./experience.service-D4S5l8TK.js";import"./httpClient-Bnjko1En.js";const L={class:"experience-form"},j={class:"header"},H={class:"form-group"},J={class:"form-group"},K={class:"form-row"},O={class:"form-group"},Q={class:"form-group"},W={class:"form-row"},X={class:"form-group"},Y={class:"form-group"},Z={class:"form-group"},h={class:"images-list"},ee=["onClick"],le={class:"form-row"},te={class:"form-group"},oe={class:"items-list"},ae=["onClick"],se={class:"form-group"},ne={class:"items-list"},ie=["onClick"],ue={class:"form-group"},re={class:"form-actions"},de=["disabled"],me={__name:"experience-form.component",setup(ce){const p=P(),v=F(),f=new T,g=M(()=>!!p.params.id),m=b(!1),x=b(null),t=b({title:"",description:"",location:"",duration:"",price:0,maxGroupSize:10,images:[""],included:[""],notIncluded:[""],important:"",categories:[],sustainability:{ecoCertifications:[],sustainablePractices:[],localCommunityImpact:""},difficulty:"medium",languages:["Español"]});$(async()=>{const a=E.fromStorage();if(!(a!=null&&a.isAgency())){v.push("/experiences");return}if(g.value)try{m.value=!0;const e=await f.getExperienceById(p.params.id);t.value={title:e.title.value,description:e.description.value,location:e.location.value,duration:e.duration.value,price:e.price.value,maxGroupSize:e.maxGroupSize,images:[...e.images],included:[...e.included],notIncluded:[...e.notIncluded],important:e.important,categories:[...e.categories],sustainability:{...e.sustainability},difficulty:e.difficulty,languages:[...e.languages]}}catch(e){console.error("Error loading experience:",e),x.value=e.message}finally{m.value=!1}});async function S(){try{m.value=!0;const a=E.fromStorage(),e={...t.value,agencyId:a.userId};g.value?await f.updateExperience(p.params.id,e):await f.createExperience(e),v.push("/manage-experiences")}catch(a){console.error("Error saving experience:",a),x.value=a.message}finally{m.value=!1}}function w(){v.push("/manage-experiences")}function N(){t.value.images.push("")}function q(a){t.value.images.splice(a,1)}function G(){t.value.included.push("")}function z(a){t.value.included.splice(a,1)}function A(){t.value.notIncluded.push("")}function B(a){t.value.notIncluded.splice(a,1)}return(a,e)=>(d(),r("div",L,[l("div",j,[l("h1",null,k(g.value?"Editar Experiencia":"Nueva Experiencia"),1)]),l("form",{onSubmit:R(S,["prevent"]),class:"form-content"},[l("div",H,[e[7]||(e[7]=l("label",null,"Título",-1)),i(u(c),{modelValue:t.value.title,"onUpdate:modelValue":e[0]||(e[0]=o=>t.value.title=o),required:""},null,8,["modelValue"])]),l("div",J,[e[8]||(e[8]=l("label",null,"Descripción",-1)),U(l("textarea",{"onUpdate:modelValue":e[1]||(e[1]=o=>t.value.description=o),class:"form-textarea",required:""},null,512),[[C,t.value.description]])]),l("div",K,[l("div",O,[e[9]||(e[9]=l("label",null,"Ubicación",-1)),i(u(c),{modelValue:t.value.location,"onUpdate:modelValue":e[2]||(e[2]=o=>t.value.location=o),required:""},null,8,["modelValue"])]),l("div",Q,[e[10]||(e[10]=l("label",null,"Duración",-1)),i(u(c),{modelValue:t.value.duration,"onUpdate:modelValue":e[3]||(e[3]=o=>t.value.duration=o),placeholder:"Ej: 2 días",required:""},null,8,["modelValue"])])]),l("div",W,[l("div",X,[e[11]||(e[11]=l("label",null,"Precio (S/)",-1)),i(u(_),{modelValue:t.value.price,"onUpdate:modelValue":e[4]||(e[4]=o=>t.value.price=o),mode:"currency",currency:"PEN",required:""},null,8,["modelValue"])]),l("div",Y,[e[12]||(e[12]=l("label",null,"Máximo de Participantes",-1)),i(u(_),{modelValue:t.value.maxGroupSize,"onUpdate:modelValue":e[5]||(e[5]=o=>t.value.maxGroupSize=o),min:1,required:""},null,8,["modelValue"])])]),l("div",Z,[e[15]||(e[15]=l("label",null,"Imágenes (URLs)",-1)),l("div",h,[(d(!0),r(y,null,V(t.value.images,(o,s)=>(d(),r("div",{key:s,class:"image-item"},[i(u(c),{modelValue:t.value.images[s],"onUpdate:modelValue":n=>t.value.images[s]=n,placeholder:"https://"},null,8,["modelValue","onUpdate:modelValue"]),l("button",{type:"button",class:"remove-button",onClick:n=>q(s)},e[13]||(e[13]=[l("i",{class:"pi pi-times"},null,-1)]),8,ee)]))),128))]),l("button",{type:"button",class:"add-button",onClick:N},e[14]||(e[14]=[l("i",{class:"pi pi-plus"},null,-1),I(" Agregar Imagen ")]))]),l("div",le,[l("div",te,[e[18]||(e[18]=l("label",null,"Incluye",-1)),l("div",oe,[(d(!0),r(y,null,V(t.value.included,(o,s)=>(d(),r("div",{key:s,class:"list-item"},[i(u(c),{modelValue:t.value.included[s],"onUpdate:modelValue":n=>t.value.included[s]=n},null,8,["modelValue","onUpdate:modelValue"]),l("button",{type:"button",class:"remove-button",onClick:n=>z(s)},e[16]||(e[16]=[l("i",{class:"pi pi-times"},null,-1)]),8,ae)]))),128))]),l("button",{type:"button",class:"add-button",onClick:G},e[17]||(e[17]=[l("i",{class:"pi pi-plus"},null,-1),I(" Agregar Item ")]))]),l("div",se,[e[21]||(e[21]=l("label",null,"No Incluye",-1)),l("div",ne,[(d(!0),r(y,null,V(t.value.notIncluded,(o,s)=>(d(),r("div",{key:s,class:"list-item"},[i(u(c),{modelValue:t.value.notIncluded[s],"onUpdate:modelValue":n=>t.value.notIncluded[s]=n},null,8,["modelValue","onUpdate:modelValue"]),l("button",{type:"button",class:"remove-button",onClick:n=>B(s)},e[19]||(e[19]=[l("i",{class:"pi pi-times"},null,-1)]),8,ie)]))),128))]),l("button",{type:"button",class:"add-button",onClick:A},e[20]||(e[20]=[l("i",{class:"pi pi-plus"},null,-1),I(" Agregar Item ")]))])]),l("div",ue,[e[22]||(e[22]=l("label",null,"Información Importante",-1)),U(l("textarea",{"onUpdate:modelValue":e[6]||(e[6]=o=>t.value.important=o),class:"form-textarea"},null,512),[[C,t.value.important]])]),l("div",re,[l("button",{type:"button",class:"cancel-button",onClick:w},"Cancelar"),l("button",{type:"submit",class:"save-button",disabled:m.value},k(m.value?"Guardando...":"Guardar"),9,de)])],32)]))}},ge=D(me,[["__scopeId","data-v-ba042372"]]);export{ge as default};
